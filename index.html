---
layout: default
---
<body id="page-top" class="index">
    <script type="text/javascript" src="./webcomponents-lite.js"></script>
    <script type="text/javascript" src="./source-code-example.js"></script>
        
    <h1>EventStore</h1>

    <p>Event.Store is an open source library to create <a href="https://martinfowler.com/eaaDev/EventSourcing.html">Event Stores</a> 
        that works with multiple persistence providers and notification systems.</p>

    <p>The Event Store is a database accompanied by a publication and subscription system.
        The database stores all the events related to an event stream. The pub / sub system allows
        other systems or microservices to react to changes in event streams. It is a core component in 
        any event sourcing + cqrs architectures.
    </p>

    <p>Event.Store has client implementations for <a href="https://github.com/thiagobustamante/node-eventstore">Node.js</a> and 
    <a href="https://github.com/biharck/eventstore">Java</a>. The two clients can interact with the same 
    Event Store.</p>

    <p>The Event Store support the folowing persistence providers:</p>
    <div style="display: flex; justify-content: space-around" >
        <img src="./images/redis-card.png" height="80px">
        <img src="./images/mongodb-logo-rgb-j6w271g1xn.jpg" height="60px">
        <img src="./images/mysql.svg" height="60px">
    </div>

    <p>And the folowing notification systems:</p>
    <div style="display: flex; justify-content: space-around" >
        <img src="./images/redis-card.png" height="80px">
        <img src="./images/rabbitmq_logo.png" height="60px">
    </div>

    <p>It is possible to create custom providers and publishers.</p>

    <h2>Installation</h2>

To install the library:

    <leanty-source-code-example id="install">
        <leanty-source label="Javascript" language="javascript">
npm install --save @eventstore.net/event.store
        </leanty-source>
        <leanty-source label="gradle" language="java">
dependencies {
    compile 'br.net.eventstore:event.store:1.0.3'
}                
        </leanty-source>
        <leanty-source label="maven" language="java">
<!-- https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-cloudwatch -->
&lt;dependency&gt;
    &lt;groupId&gt;br.net.eventstore&lt;/groupId&gt;
    &lt;artifactId&gt;event.store&lt;/artifactId&gt;
    &lt;version&gt;1.0.3&lt;/version&gt;
&lt;/dependency&gt;
        </leanty-source>
</leanty-source-code-example>
    
    <h2>Usage Guide</h2>

    <h3>Create EventStore</h3>

    <p>To Create an EventStore you must provide two implementations:</p>
    <ul>
        <li>A persistence <b>Provider</b>: Responsible for events persistence in the store.</li>
        <li>A notification <b>Publisher</b> (Optional): Responsible for notify any process interested in modifications
            on the store streams.</li>
    </ul>
    <p>If there is no publisher provided, the event store will not send any notification.</p>

    <leanty-source-code-example id="create">
        <leanty-source label="Javascript" language="javascript">
const eventStore = new EventStore(
    new InMemoryProvider(), // The persistence provider. Could use different providers, like MongoDB etc
    new InMemoryPublisher()); // Opcional. Support different publishers, like RabbitmqPublisher, RedisPublisher etc
        </leanty-source>
        <leanty-source label="Java" language="java">
EventStore eventStore = new EventStoreBuilder()
    .setProvider(new InMemoryProvider()) // The persistence provider. Could use different providers, like MongoDB etc
    .setPublisher(new InMemoryPublisher()) // Opcional. Support different publishers, like RabbitmqPublisher, RedisPublisher etc
    .createEventStore();
        </leanty-source>
    </leanty-source-code-example>

    <h3>Adding to Events</h3>

    <p>
        To add Events you need to ask to EventStore a reference to an <b>EventStream</b>. 
        You can add Events passing anything you want as a payload.
    </p>

    <leanty-source-code-example id="add">
        <leanty-source label="Javascript" language="javascript">
const ordersStream = eventStore.getEventStream('orders', '1234567');
ordersStream.addEvent({ payload: 'My Event Payload'}); // Could pass anything here
        </leanty-source>
        <leanty-source label="Java" language="java">
EventStream ordersStream = eventStore.getEventStream("orders", "1234567");
ordersStream.addEvent(new Event("My Event Payload")); // Could pass a JSON string here
        </leanty-source>
    </leanty-source-code-example>

    <h3>Reading to Events</h3>

    <p>
        To read Events you need to ask to EventStore a reference to an <b>EventStream</b>. 
        You can read a stream to receive an ordered list containing all the events in the store.
    </p>

    <leanty-source-code-example id="read">
        <leanty-source label="Javascript" language="javascript">
const ordersStream = eventStore.getEventStream('orders', '1234567');
const events = await ordersStream.getEvents();
const order = ordersAggregation.loadFromHistory(events)
        </leanty-source>
        <leanty-source label="Java" language="java">
EventStream ordersStream = eventStore.getEventStream("orders", "1234567");
List&lt;Event&gt; events = ordersStream.getEvents();
Order order = ordersAggregation.loadFromHistory(events)
        </leanty-source>
    </leanty-source-code-example>


    <h3>Reacting to Events</h3>

    <p>
        You can add subscribers to be notified every time a new event is added in any stream contained in the given aggregation.
        The following example will be notified for every new event in any stream in the "orders" aggregation.
    </p>

    <leanty-source-code-example id="react">
        <leanty-source label="Javascript" language="javascript">
eventStore.subscribe('orders', message => {
    console.log(message.aggregation);
    console.log(message.streamId);
    console.log(message.event.payload);
});
        </leanty-source>
        <leanty-source label="Java" language="java">
eventStore.subscribe("orders", message -> {
    System.out.println(message.getAggregation());
    System.out.println(message.getStreamId());
    System.out.println(getEvent().getPayload());
});
        </leanty-source>
    </leanty-source-code-example>    

    <h3>Reacting to Events</h3>

    <leanty-description>
        <p>
            You can add subscribers to be notified every time a new event is added in any stream contained in the given aggregation.
            The above example will be notified for every new event in any stream in the "orders" aggregation.
        </p>
    </leanty-description>

    <leanty-source-code-example id="react">
        <leanty-source label="Javascript" language="javascript">
const subscription = await eventStore.subscribe('orders', message => {
    console.log(message.aggregation);
    console.log(message.streamId);
    console.log(message.event.payload);
});
// ...
subscription.remove();
        </leanty-source>
        <leanty-source label="Java" language="java">
Subscription subscription = eventStore.subscribe("orders", message -> {
    System.out.println(message.getAggregation());
    System.out.println(message.getStreamId());
    System.out.println(getEvent().getPayload());
});

// ...
subscription.remove();
        </leanty-source>
    </leanty-source-code-example>    

</body>
